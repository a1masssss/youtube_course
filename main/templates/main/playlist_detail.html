{% extends 'main/base.html' %}
{% load static %}

{% block title %}{{ playlist.title }} - Course Summarizer{% endblock %}

{% block extra_css %}
<link href="{% static 'main/css/playlist_detail.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="container">
    <div class="playlist-header">
        <div class="playlist-info">
            <h1 class="playlist-title">
                <i class="fab fa-youtube"></i>
                {{ playlist.title }}
            </h1>
            <div class="playlist-meta">
                <span class="video-count">
                    <i class="fas fa-video"></i>
                    {{ playlist.videos.count }} videos
                </span>
                <a href="{{ playlist.playlist_url }}" target="_blank" class="playlist-link">
                    <i class="fas fa-external-link-alt"></i>
                    View on YouTube
                </a>
            </div>
        </div>
        
        <div class="playlist-actions">
            <button id="toggle-view" class="toggle-btn">
                <i class="fas fa-th-list"></i>
                List View
            </button>
            <button id="export-summaries" class="export-btn">
                <i class="fas fa-download"></i>
                Export
            </button>
        </div>
    </div>

    <div class="videos-container" id="videos-container">
        {% for video in playlist.videos.all %}
        <div class="video-card" data-video-id="{{ video.id }}">
            <div class="video-thumbnail">
                <img src="{{ video.thumbnail }}" alt="{{ video.title }}" loading="lazy">
                <div class="video-overlay">
                    <button class="play-btn" onclick="openVideo('{{ video.url }}')">
                        <i class="fas fa-play"></i>
                    </button>
                </div>
            </div>
            
            <div class="video-content">
                <h3 class="video-title">{{ video.title }}</h3>
                
                <div class="video-summary">
                    <div class="summary-header">
                        <h4>
                            <i class="fas fa-brain"></i>
                            AI Summary
                        </h4>
                        <button class="toggle-summary" onclick="toggleSummary({{ video.id }})">
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                    
                    <div class="summary-content" id="summary-{{ video.id }}">
                        {% if video.summary %}
                            <p>{{ video.summary }}</p>
                        {% else %}
                            <p class="no-summary">No summary available</p>
                        {% endif %}
                    </div>
                </div>
                
                <div class="video-actions">
                    <button class="action-btn" onclick="copyToClipboard('{{ video.summary|escapejs }}')">
                        <i class="fas fa-copy"></i>
                        Copy Summary
                    </button>
                    <button class="action-btn" onclick="viewTranscript({{ video.id }})">
                        <i class="fas fa-file-text"></i>
                        View Transcript
                    </button>
                    <a href="{{ video.url }}" target="_blank" class="action-btn">
                        <i class="fas fa-external-link-alt"></i>
                        Watch Video
                    </a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="empty-state">
            <i class="fas fa-video-slash"></i>
            <h3>No videos found</h3>
            <p>This playlist appears to be empty or couldn't be processed.</p>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Transcript Modal -->
<div id="transcript-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Full Transcript</h3>
            <button class="close-btn" onclick="closeModal()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div id="transcript-content"></div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'main/js/playlist_detail.js' %}"></script>
{% endblock %} 